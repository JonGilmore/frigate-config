# yaml-language-server: $schema=http://192.168.30.249:5005/api/config/schema.json
version: 0.14
detectors:
  coral1:
    type: edgetpu
    device: usb:0
  coral2:
    type: edgetpu
    device: usb:1

model:
  path: "{FRIGATE_PLUS}"

database:
  path: /config/frigate.db

mqtt:
  host: 192.168.30.249
  topic_prefix: frigate
  user: frigate
  password: "{FRIGATE_MQTT_PASSWORD}"

record:
  enabled: true
  retain:
    mode: all
  events:
    pre_capture: 2
    retain:
      default: 40
      mode: all

timestamp_style:
  position: tr
  effect: solid

snapshots:
  enabled: true
  clean_copy: true
  timestamp: false
  crop: true
  retain:
    default: 20
    objects:
      person: 30

ffmpeg:
  hwaccel_args: preset-nvidia-h264
  output_args:
    record: preset-record-generic-audio-aac

detect:
  fps: 5
  width: 1280
  height: 720

objects:
  track:
    - person
    - cat
    - dog
  filters:
    person:
      min_score: 0.6
      threshold: 0.8
    dog:
      threshold: 0.86

go2rtc:
  streams:
    doorbell:
      - rtsp://ha:{FRIGATE_HA_AXIS}@192.168.30.130:554/axis-media/media.amp?videocodec=h264&resolution=1920x1080
    doorbell_sub:
      - rtsp://ha:{FRIGATE_HA_AXIS}@192.168.30.130:554/axis-media/media.amp?videocodec=h264&resolution=1280x720
    workshop:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.131:554/cam/realmonitor?channel=1&subtype=0
    workshop_sub:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.131:554/cam/realmonitor?channel=1&subtype=2
    deck:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.132:554/cam/realmonitor?channel=1&subtype=0
    deck_sub:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.132:554/cam/realmonitor?channel=1&subtype=2
    frontyard:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.133:554/cam/realmonitor?channel=1&subtype=0
    frontyard_sub:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.133:554/cam/realmonitor?channel=1&subtype=2
    garage:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.134:554/cam/realmonitor?channel=1&subtype=0
    garage_sub:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.134:554/cam/realmonitor?channel=1&subtype=2
    driveway:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.137:554/cam/realmonitor?channel=1&subtype=0
    driveway_sub:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.137:554/cam/realmonitor?channel=1&subtype=2
    grilldeck:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.135:554/cam/realmonitor?channel=1&subtype=0
    grilldeck_sub:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.135:554/cam/realmonitor?channel=1&subtype=2
    mudroom:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.136:554/cam/realmonitor?channel=1&subtype=0
    mudroom_sub:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.136:554/cam/realmonitor?channel=1&subtype=2
    patio:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.138:554/cam/realmonitor?channel=1&subtype=0
    patio_sub:
      - rtsp://admin:{FRIGATE_RTSP_PASSWORD}@192.168.31.138:554/cam/realmonitor?channel=1&subtype=2
  webrtc:
    candidates:
      - 192.168.30.249:8555
      - stun:8555

cameras:
  #  theta:
  #    ffmpeg:
  #      input_args: "-avoid_negative_ts make_zero -fflags +genpts+discardcorrupt -rtsp_transport tcp -use_wallclock_as_timestamps 1 -an"
  #      inputs:
  #        - path: rtsp://192.168.30.2:7447/{FRIGATE_UI}
  #          roles:
  #            - detect
  #            - record
  #    detect:
  #      width: 1280
  #      height: 1280
  #      fps: 15
  #    mqtt:
  #      timestamp: False
  #      bounding_box: False
  #      crop: True
  #      quality: 100
  #      height: 500
  doorbell:
    motion:
      mask: 1,0,1,1,0.743,1,0.793,0.793,0.811,0.628,0.544,0.58,0.485,0
    zones:
      doorbell_near:
        coordinates: 0.73,1,0.785,0.792,0.545,0.7,0.502,0.626,0.384,0.643,0.313,0.786,0.289,1
        inertia: 3
      doorbell_far:
        coordinates: 0.544,0.696,0.658,0.747,0.79,0.79,0.809,0.637,0.542,0.585
        inertia: 3
    ffmpeg:
      inputs:
        - path: rtsp://192.168.30.249:8554/doorbell
          input_args: preset-rtsp-restream
          roles:
            - record
        - path: rtsp://192.168.30.249:8554/doorbell_sub
          input_args: preset-rtsp-restream
          roles:
            - detect
    objects:
      filters:
        cat: {}
        dog: {}
        person:
          min_area: 10000
          max_area: 320000
      mask: 0.305,1,0.248,0.535,0.292,0.142,0.54,0.141,0.541,0.003,0,0,0,1
    mqtt:
      timestamp: false
      bounding_box: false
      crop: true
      quality: 100
      height: 500
    review:
      detections:
        required_zones:
          - doorbell_far
          - doorbell_near
      alerts:
        required_zones: doorbell_near
  workshop:
    motion:
      mask: 1,0,1,1,0.455,1,0.563,0.607,0.723,0.439,0.85,0.5,0.868,0.26,0.42,0
    zones:
      workshop_far:
        coordinates: 0.219,0.409,0.284,0.489,0.383,0.54,0.6,0.561,0.79,0.364,0.575,0.193,0.3,0.061,0.104,0.046,0.062,0.379
        inertia: 3
      workshop_near:
        coordinates: 0.604,0.568,0.457,1,0.18,1,0.05,0.557,0.212,0.412,0.375,0.543
        inertia: 3
    ffmpeg:
      output_args:
        record: preset-record-generic-audio-copy
      inputs:
        - path: rtsp://192.168.30.249:8554/workshop
          input_args: preset-rtsp-restream
          roles:
            - record
        - path: rtsp://192.168.30.249:8554/workshop_sub
          input_args: preset-rtsp-restream
          roles:
            - detect
    objects:
      filters:
        cat:
          min_area: 5000
        dog:
          min_area: 5000
        person:
          min_area: 32000
          max_area: 320000
      mask: 0.451,0.997,0.592,0.59,0.725,0.446,0.848,0.491,0.894,0.318,0.335,0,1,0,1,1
    mqtt:
      timestamp: false
      bounding_box: false
      crop: true
      quality: 100
      height: 500
    review:
      detections:
        required_zones:
          - workshop_far
          - workshop_near
      alerts:
        required_zones: workshop_near
  deck:
    motion:
      mask: 0.098,0.489,0,0.46,0,0,1,0,1,0.407,0.893,0.342,0.833,0.431,0.649,0.329,0.432,0.421
    zones:
      deck_far:
        coordinates: 0.335,1,0.888,0.62,0.969,0.661,1,0.547,0.967,0.436,0.879,0.369,0.78,0.523,0.644,0.422,0.257,0.706
        inertia: 3
      deck_near:
        coordinates: 0.347,1,0.852,1,0.927,0.803,0.97,0.663,0.888,0.622
        inertia: 3
    ffmpeg:
      inputs:
        - path: rtsp://192.168.30.249:8554/deck
          input_args: preset-rtsp-restream
          roles:
            - record
        - path: rtsp://192.168.30.249:8554/deck_sub
          input_args: preset-rtsp-restream
          roles:
            - detect
    objects:
      filters:
        cat:
          min_area: 9000
        dog:
          min_area: 9000
        person:
          min_area: 16000
          max_area: 130000
    mqtt:
      timestamp: false
      bounding_box: false
      crop: true
      quality: 100
      height: 500
    review:
      detections:
        required_zones:
          - deck_far
          - deck_near
  frontyard:
    motion:
      mask:
        - 1280,720,1280,654,1173,720
        - 202,624,215,430,64,327,36,137,252,21,377,102,393,0,0,0,0,720,290,720
        - 1280,0,1280,272,1209,229,1011,127,794,47,624,0
    zones:
      driveway_near:
        coordinates: 0.416,0.046,0.632,0.376,1,1,0.356,1,0.311,0.301,0.281,0.109
        inertia: 3
      driveway_far:
        coordinates: 0.42,0.049,0.542,0.032,0.719,0.131,0.893,0.265,1,0.395,1,1,0.605,0.329
        inertia: 3
      front_porch:
        coordinates: 0.352,1,0.218,1,0.082,0.704,0.11,0.408,0.311,0.31
        inertia: 3
      doorbell_far:
        coordinates: 0.295,0.59,0.554,0.5,0.454,0.233,0.274,0.291
        inertia: 3
      doorbell_near:
        coordinates: 0.104,0.367,0.063,0.65,0.291,0.585,0.273,0.299
        inertia: 3
    ffmpeg:
      inputs:
        - path: rtsp://192.168.30.249:8554/frontyard
          input_args: preset-rtsp-restream
          roles:
            - record
        - path: rtsp://192.168.30.249:8554/frontyard_sub
          input_args: preset-rtsp-restream
          roles:
            - detect
    objects:
      filters:
        car:
          min_area: 8000
        motorcycle:
          min_area: 1000
        person:
          min_area: 8000
          max_area: 60000
      track:
        - person
        - cat
        - dog
        - car
        - motorcycle
      mask: 0.479,0.001,0.657,0.083,0.823,0.2,1,0.377,1,0
    mqtt:
      timestamp: false
      bounding_box: false
      crop: true
      quality: 100
      height: 500
    review:
      detections:
        required_zones:
          - doorbell_far
          - doorbell_near
          - driveway_far
          - driveway_near
          - front_porch
      alerts:
        required_zones:
          - doorbell_near
          - driveway_near
  garage:
    motion:
      mask:
        - 802,50,640,40,638,0,806,0
    ffmpeg:
      inputs:
        - path: rtsp://192.168.30.249:8554/garage
          input_args: preset-rtsp-restream
          roles:
            - record
        - path: rtsp://192.168.30.249:8554/garage_sub
          input_args: preset-rtsp-restream
          roles:
            - detect
    objects:
      filters:
        person:
          min_area: 35000
          max_area: 320000
          min_score: 0.75
          threshold: 0.75
    mqtt:
      timestamp: false
      bounding_box: false
      crop: true
      quality: 100
      height: 500
  driveway:
    motion:
      mask:
        - 1280,411,1280,0,0,0,0,315,251,189,505,105,781,45,971,33,1127,121,1080,369
    snapshots:
      required_zones:
        - driveway_near
        - driveway_far
    zones:
      driveway_near:
        coordinates: 0,1,0.82,1,0.786,0.728,0.888,0.364,0.884,0.169,0.799,0.092,0,0.718
        inertia: 3
      driveway_far:
        coordinates: 0.463,0.123,0.675,0.055,0.797,0.092,0,0.715,0,0.45,0.174,0.288,0.297,0.206
        inertia: 3
    ffmpeg:
      inputs:
        - path: rtsp://192.168.30.249:8554/driveway
          input_args: preset-rtsp-restream
          roles:
            - record
        - path: rtsp://192.168.30.249:8554/driveway_sub
          input_args: preset-rtsp-restream
          roles:
            - detect
    objects:
      filters:
        car:
          min_area: 10000
        motorcycle:
          min_area: 1000
        person:
          min_area: 5000
          max_area: 105000
      track:
        - person
        - cat
        - dog
        - car
        - motorcycle
    mqtt:
      timestamp: false
      bounding_box: false
      crop: true
      quality: 100
      height: 500
    review:
      alerts:
        required_zones:
          - driveway_near
          - driveway_far
      detections:
        required_zones:
          - driveway_far
          - driveway_near
  grilldeck:
    motion:
      mask:
        - 0.685,0,1,0,1,0.274,1,0.537,0.866,0.475,0.714,0.682,0.627,0.625,0.568,0.357,0.617,0.199
        - 0.279,0.586,0.235,0.173,0.482,0.135,0.516,0.306,0.476,0.505
    zones:
      grilldeck_far:
        coordinates: 1045,412,1140,593,927,720,696,720,650,552
      grilldeck_near:
        coordinates: 734,465,1052,387,885,123,366,114,262,0,56,96,292,720,695,720,654,549
    ffmpeg:
      inputs:
        - path: rtsp://192.168.30.249:8554/grilldeck
          input_args: preset-rtsp-restream
          roles:
            - record
        - path: rtsp://192.168.30.249:8554/grilldeck_sub
          input_args: preset-rtsp-restream
          roles:
            - detect
    objects:
      filters:
        cat:
          max_area: 45000
        dog:
          max_area: 55000
        person:
          min_area: 18000
          max_area: 180000
    mqtt:
      timestamp: false
      bounding_box: false
      crop: true
      quality: 100
      height: 500
  mudroom:
    zones:
      mudroom_far:
        coordinates: 1011,642,1118,409,1200,79,908,0,653,0,670,406
      mudroom_near:
        coordinates: 964,720,398,720,171,129,626,0,656,417,1006,654
    ffmpeg:
      inputs:
        - path: rtsp://192.168.30.249:8554/mudroom
          input_args: preset-rtsp-restream
          roles:
            - record
        - path: rtsp://192.168.30.249:8554/mudroom_sub
          input_args: preset-rtsp-restream
          roles:
            - detect
    objects:
      filters:
        person:
          min_area: 35000
          max_area: 180000
    mqtt:
      timestamp: false
      bounding_box: false
      crop: true
      quality: 100
      height: 500
  patio:
    motion:
      mask: 0.227,0.036,0.283,0.194,0.298,0.82,0.477,0.735,0.455,0.637,0.389,0.176,0.399,0,0,0,0,0.296
    zones:
      patio_near:
        coordinates: 1,1,1,0.554,0.923,0.495,0,0.865,0,1
        inertia: 3
      patio_far:
        coordinates: 0,0.35,0.858,0.153,0.952,0.301,0.911,0.497,0,0.861
        inertia: 3
    ffmpeg:
      inputs:
        - path: rtsp://192.168.30.249:8554/patio
          input_args: preset-rtsp-restream
          roles:
            - record
        - path: rtsp://192.168.30.249:8554/patio_sub
          input_args: preset-rtsp-restream
          roles:
            - detect
    objects:
      filters:
        cat: {}
        dog: {}
        person:
          min_area: 4000
          max_area: 142000
          min_score: 0.76
          threshold: 0.76
    mqtt:
      timestamp: false
      bounding_box: false
      crop: true
      quality: 100
      height: 500
    review:
      alerts:
        required_zones: patio_near
      detections:
        required_zones:
          - patio_near
          - patio_far
